<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCAP: Developer Notes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCAP
   </div>
   <div id="projectbrief">Electronic structure of metastable states</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Developer Notes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md0"></a>
Key Classes</h1>
<p><b>System</b></p>
<p>The <a class="el" href="class_system.html" title="Class which holds molecular geometry and basis set data. ">System</a> class stores the geometry and the basis set. OpenCAP supports both inline specification and parsing from post-processing files generated by the package such as Molden and FCHK. The latter is preferred as it greatly decreases the odds of getting the GTO ordering wrong. The System class computes the overlap matrix, which is used to verify the GTO ordering.</p>
<p><b>Basis Set</b></p>
<p>In the <a class="el" href="class_basis_set.html" title="Object for storing basis set information. ">BasisSet</a> class, basis functions are stored in the form of <a class="el" href="class_shell.html" title="Class for a group of atomic orbitals with the same angular momentum and exponents. ">Shell</a> objects, which contain the angular momentum, exponents, coefficients, and center. The ordering of the individual basis functions is stored in bf_ids vector. Each basis function has a four-part <a class="el" href="structbf__id.html" title="Struct for ID of basis function. ">bf_id</a>:</p>
<p>atom index, shell number, angular momentum quantum number(l), magnetic quantum number(m)</p>
<p>e.g: (1,1,3,-2)</p>
<p>These IDs are used to create the mapping between OpenCAP ordering of GTOs and the quantum chemistry package's ordering.</p>
<p><b>CAP</b></p>
<p>The <a class="el" href="class_c_a_p.html" title="Class which handles computing the CAP matrix. ">CAP</a> class handles computing the CAP matrix and post-processing of densities and the zeroth order Hamiltonian. The densities are stored in two 2D vectors, one for alpha and the other for beta densities. It ultimately computes and stores the CAP matrices in atomic orbital and state basis.</p>
<p><b>AOCAP</b></p>
<p>The <a class="el" href="class_a_o_c_a_p.html" title="Class for numerically integrating the CAP matrix in AO basis. ">AOCAP</a> class handles numerical integration of the CAP matrix. It uses the <a href="https://github.com/dftlibs/numgrid">Numgrid</a> library to allocate the grid for each atom.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
How to add support for new packages</h1>
<p>The following is required to develop an interface with a new package:</p>
<ul>
<li>Knowledge of ordering of GTOs, both Cartesian and Harmonic</li>
<li>Overlap matrix</li>
<li>1 particle transition density matrices between each state and 1RDMs</li>
<li>Zeroth order Hamiltonian</li>
<li>New keywords</li>
</ul>
<p><b>GTOs and Overlap Matrix</b></p>
<p>It is not possible to represent the CAP in state basis without knowing the ordering of the one-particle densities. Unfortunately, this information is seldom documented in easy to find places. The overlap matrix is our best tool for figuring out how the basis set is ordered, as it is almost always computed by electronic structure packages, and is usually available in post-processing files. Once you have figured out how the basis set is ordered, you need to add functions to gto_ordering.cpp which describe the mapping from your packages ordering to OpenCAP ordering. Use the IDs described in the Basis Set section to create this mapping.</p>
<p><b>One-particle densities</b></p>
<p>One particle densities should be represented in AO basis, and then transformed to OpenCAP ordering using "to_opencap_ordering", for use by the <a class="el" href="class_c_a_p.html" title="Class which handles computing the CAP matrix. ">CAP</a> class. In principle, one can read them in in MO basis, and then transform to AO basis, but this requires knowledge of the MO coefficients. When adding support for a new package, a new file 'package_interface.cpp' should be added.</p>
<p><b>Zeroth Order Hamiltonian</b></p>
<p>It is strongly recommended to create functions which parse the zeroth order Hamiltonian from standard output files. These functions should be added to the 'package_interface.cpp' file.</p>
<p><b>Keywords</b></p>
<p>keywords.cpp must be edited to allow new for new keywords. There are two types of keywords: "open", which can have many different values, and "closed", which can only have certain values. Additionally, the verify_method, read_in_dms, and read_in_zero_order_H methods of <a class="el" href="class_c_a_p.html" title="Class which handles computing the CAP matrix. ">CAP</a> must be modified, as well as anywhere else where GTO ordering is required to include the new interface. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
