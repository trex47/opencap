<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCAP: Input</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCAP
   </div>
   <div id="projectbrief">Electronic structure of metastable states</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Input </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md2"></a>
Input sections</h1>
<p>An OpenCAP input file has four sections:</p>
<p>$system, $perturb_cap, $job, and optionally, $geometry</p>
<p>Within each section, the user inserts keyword/value pairs which define the calculation. All four sections have their own unique keywords, and all four must be specified to run a calculation. The general format is: </p><pre class="fragment">$section_name

keyword  value

keyword  value

$end
</pre><p>In each section, the parser will read lines until it sees the $end keyword. Only the first two arguments per line are read, so all remaining text can be used as comments. Additionally, lines beginning with an exclamation mark '!' are ignored. All input sections are case-insensitive.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Job </h1>
<p>This section specifies what type of job is to be executed by the software.</p>
<p><b>Required</b> </p><table class="doxtable">
<tr>
<th align="center">Keyword </th><th>Type </th><th>Description </th><th>Valid options  </th></tr>
<tr>
<td align="center">title </td><td>string </td><td>Title of job </td><td>N/A </td></tr>
<tr>
<td align="center">jobtype </td><td>string </td><td>Type of job to be executed </td><td>perturb_cap </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md4"></a>
System</h1>
<p>The system section specifies information about the molecular system and the ab initio basis set. Basis sets can be downloaded from the <a href="https://www.basissetexchange.org/">MolSSI</a> and modified to suit your purposes.</p>
<p><b>Required</b> </p><table class="doxtable">
<tr>
<th>Keyword </th><th>Valid options </th><th>Description  </th></tr>
<tr>
<td>molecule </td><td>molden,qchem_fchk,rassi_h5,inline </td><td>Specifies which format to read the molecular geometry. If "inline" is chosen, the "$geometry" section is also required. </td></tr>
<tr>
<td>basis_file </td><td>path to basis file </td><td>Specifies the path to the basis file. When "molecule" is set to "molden","rassi_h5", or "qchem_fchk", this keyword should be set to a path to a file of the specified type. When "molecule" is set to "inline", this keyword should be set to a path to a basis set file formatted in "Psi4" style. </td></tr>
</table>
<p><b>Optional</b> </p><table class="doxtable">
<tr>
<th>Keyword </th><th>default </th><th>Description  </th></tr>
<tr>
<td>cart_bf </td><td>""(all functions pure) </td><td>Controls the use of pure or Cartesian angular forms of GTOs. The letters corresponding to the angular momenta listed in this field will be expanded in cartesians, those not listed will be expanded in pure GTOs. For example, "df" means d and f-type functions will be cartesian, and all others will be pure harmonic. This keyword is only active when "molecule" is set to "inline". </td></tr>
<tr>
<td>bohr_coordinates </td><td>false </td><td>Set to true when coordinates specified in "geometry" keyword are in bohr units. This keyword is only active when "molecule" is set to "inline". </td></tr>
</table>
<p><b>Geometry</b></p>
<p>When specifying the geometry inline, use the following format: </p><pre class="fragment">atom1 x-coordinate y-coordinate z-coordinate 

atom2 x-coordinate y-coordinate z-coordinate ...
</pre><p>Ghost centers with zero nuclear charge can be specified using the symbol "X".</p>
<p>By default, units are assumed to be Angstroms.</p>
<h1><a class="anchor" id="autotoc_md5"></a>
Perturb_CAP</h1>
<p>This section allows one to specify the parameters used to define the complex absorbing potential, the data read in from the electronic structure calculation, and the grid used for numerical integration.</p>
<p>There are two key pieces of data which must be read in from the electronic structure package: the set of one particle transition densities between each pair of states (each has a dimension of NxN where N is the number of basis functions), and the zeroth order Hamiltonian (which has a dimension of MxM, where M is the number of electronic states computed by the package). In some cases, the zeroth order Hamiltonian can be read directly from the output file of the electronic structure package, but in other cases it may be easier to just specify the zeroth order hamiltonian manually (due to its small dimensionality). For the latter option, the 'h0_file' keyword must be used, and the value must point to a properly formatted file.</p>
<p>A properly formatted zeroth order hamiltonian file can have one of two forms. The first is the diagonal form (where the zeroth order hamiltonian just consists of total energies on the diagonal, as is the case for EOM-CCSD), the word "Diagonal" must appear on the first line, followed by the energies, each on their own line. The second is the full form, in which the entire zeroth order hamiltonian is specified. The word "Full" must appear on the first line, followed by the matrix. The matrix is read in row-major order. See the <a href="https://github.com/gayverjr/opencap/blob/master/examples/opencap/heff.in">repository</a> for an example.</p>
<p>We currently support two types of complex absorbing potentials; quadratic box-type potentials, and a quadratic "Voronoi isosurface" potential. Both types of CAP have their own set of parameters which must be defined. Numerical integration is performed with the aid of the <a href="https://github.com/dftlibs/numgrid">numgrid</a> package, which allocates the grid based on the molecular geometry and basis set. By default, a radial grid with precision 1e-14 is used, with an angular grid of 590 points. Both can optionally be adjusted to increase or decrease the size of the grid as needed.</p>
<p><b>Required</b> </p><table class="doxtable">
<tr>
<th align="center">Keyword </th><th>Type </th><th>Description </th><th>Valid options  </th></tr>
<tr>
<td align="center">cap_type </td><td>string </td><td>Type of absorbing potential</td><td>'Box' or 'Voronoi' </td></tr>
<tr>
<td align="center">Method </td><td>string </td><td>Name of electronic structure method </td><td>For OpenMolcas: MS-CASPT2, XMS-CASPT2 </td></tr>
<tr>
<td align="center">Package </td><td>string </td><td>Name of electronic structure package </td><td>OpenMolcas </td></tr>
<tr>
<td align="center">Nstates </td><td>int </td><td>Number of electronic states </td><td>2 or greater </td></tr>
</table>
<p><b>OpenMolcas Interface</b> </p><table class="doxtable">
<tr>
<th>Keyword </th><th>Type </th><th>Description  </th></tr>
<tr>
<td>rassi_h5 </td><td>string </td><td>Relative or absolute path to rassi.h5 file containing TDMs. </td></tr>
<tr>
<td>molcas_output </td><td>string </td><td>Relative or absolute path to OpenMolcas output file. Required when h0_file keyword is unspecified. </td></tr>
</table>
<p><b>Box CAP</b></p>
<p>A quadratic potential which encloses the system in a 3D rectangular box. Functional form:</p>
<p>\( W= W_x + W_y +W_z \)</p>
<p>\( W_{\alpha} = 0\), \( \left|r_{\alpha}\right| &lt; R_{\alpha}^0 \)</p>
<p>\( W_{\alpha} = \left(r_{\alpha} - R_{\alpha}^0 \right)^2,\) \( \left|r_{\alpha}\right| &gt; R_{\alpha}^0 \)</p>
<table class="doxtable">
<tr>
<th>Keyword </th><th>Type </th><th>Description  </th></tr>
<tr>
<td>CAP_X </td><td>float </td><td>Onset of CAP in x-direction. Specify in bohr units. </td></tr>
<tr>
<td>CAP_Y </td><td>float </td><td>Onset of CAP in y-direction. Specify in bohr units. </td></tr>
<tr>
<td>CAP_Z </td><td>float </td><td>Onset of CAP in z-direction. Specify in bohr units. </td></tr>
</table>
<p><b>Voronoi CAP</b></p>
<p>A quadratic potential which uniformly wraps around the system at a specified cutoff radius. The edges between between Voronoi cells are smoothed out to make the potential more amenable to numerical integration[1]. Functional form:</p>
<p>\( W(\vec{r}) = 0,\) \(r_{WA} \leq r_{cut} \)</p>
<p>\( W(\vec{r}) = (r_{WA} - r_{cut} )^2,\) \(r_{WA} &gt; r_{cut} \)</p>
<p>\( r_{WA}(\vec{r}) = \sqrt{\frac{\sum_{i} w_{i}|\vec{r}-\vec{R}_i|^2}{\sum_{i} w_{i}}} \)</p>
<p>\( w_{i} = \frac{1}{(|\vec{r}-\vec{R}_i|^2-r_{min}^2+1 a.u.)^2} \)</p>
<p>\( r_{min} = \min\limits_{i}{|\vec{r}-\vec{R}_i|} \)</p>
<table class="doxtable">
<tr>
<th>Keyword </th><th>Type </th><th>Description  </th></tr>
<tr>
<td>r_cut </td><td>float </td><td>Cutoff radius for Voronoi CAP. Specify in bohr units. </td></tr>
</table>
<p><b>Optional</b> </p><table class="doxtable">
<tr>
<th>Keyword </th><th>Type </th><th>Description </th><th>Default  </th></tr>
<tr>
<td>radial_precision</td><td>int </td><td>Radial precision for numerical integration grid. A precision of 1x10^(-N), where N is the value specified is used. </td><td>14 </td></tr>
<tr>
<td>angular_points </td><td>int </td><td>Number of angular ponts used for the grid. See <a href="https://github.com/dftlibs/numgrid">https://github.com/dftlibs/numgrid</a> for allowed numbers of points. </td><td>590 </td></tr>
<tr>
<td>h0_file </td><td>string </td><td>Relative or absolute path to formatted zeroth order Hamiltonian file. Required when output from electronic structure package (e.g. molcas_output) is unspecified. </td><td>"" </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md6"></a>
References</h1>
<p>[1] Sommerfeld, T.; Ehara, M. Complex Absorbing Potentials with Voronoi Isosurfaces Wrapping Perfectly around Molecules. <em>J. Chem. Theory Comput.</em> <b>2015</b>, 11 (10), 4627–4633. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
